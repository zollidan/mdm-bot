<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>mdm bot ‚Äî –≥–ª–∞–≤–Ω–∞—è</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700;800&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Plus Jakarta Sans", sans-serif;
        background-color: #fffef9;
        -webkit-tap-highlight-color: transparent;
      }

      .neo-shadow {
        box-shadow: 4px 4px 0px 0px rgba(0, 0, 0, 1);
      }

      .neo-shadow-sm {
        box-shadow: 2px 2px 0px 0px rgba(0, 0, 0, 1);
      }

      .neo-press:active {
        transform: translate(2px, 2px);
        box-shadow: none;
      }

      .neo-hover:hover {
        transform: translate(2px, 2px);
        box-shadow: none;
      }

      /* Custom scrollbar for neo-brutalism */
      ::-webkit-scrollbar {
        width: 10px;
      }
      ::-webkit-scrollbar-track {
        background: #fffef9;
      }
      ::-webkit-scrollbar-thumb {
        background: #000;
        border: 2px solid #fffef9;
        border-radius: 10px;
      }
    </style>
  </head>
  <body class="text-black antialiased selection:bg-[#FCD34D]">
    <!-- Header -->
    <header class="sticky top-0 z-50 p-4">
      <nav
        class="flex items-center justify-between bg-white border-2 border-black rounded-2xl p-4 neo-shadow"
      >
        <div class="flex items-center gap-2">
          <div
            class="w-8 h-8 bg-[#FCD34D] border-2 border-black rounded-lg flex items-center justify-center font-extrabold"
          >
            m
          </div>
          <h1 class="text-xl font-extrabold tracking-tight">mdm bot</h1>
        </div>
        <div
          id="api-status"
          class="flex items-center gap-2 px-3 py-1 bg-green-100 border-2 border-black rounded-full text-xs font-bold"
        >
          <span class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></span>
          ONLINE
        </div>
      </nav>
    </header>

    <main class="p-4 space-y-8">
      <!-- Hero Section -->
      <section
        class="bg-[#FCD34D] border-2 border-black rounded-3xl p-6 neo-shadow space-y-4"
      >
        <h2 class="text-4xl font-extrabold leading-none lowercase italic">
          —Ç–≤–æ–π –Ω–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å —à–æ–ø–ø–∏–Ω–≥–∞
        </h2>
        <p class="text-lg font-bold opacity-80">
          –õ—É—á—à–∏–µ —Ç–æ–≤–∞—Ä—ã –ø—Ä—è–º–æ –≤–Ω—É—Ç—Ä–∏ —Ç–≤–æ–µ–≥–æ Telegram. –ë—ã—Å—Ç—Ä–æ, —Å—Ç–∏–ª—å–Ω–æ, –Ω–∞–¥–µ–∂–Ω–æ.
        </p>
        <a
          href="/products"
          class="inline-block w-full py-4 bg-white border-2 border-black rounded-2xl text-center font-extrabold text-xl neo-shadow neo-press transition-all"
        >
          –æ—Ç–∫—Ä—ã—Ç—å –∫–∞—Ç–∞–ª–æ–≥ ‚Üó
        </a>
      </section>

      <!-- Stats Grid -->
      <section class="grid grid-cols-2 gap-4">
        <div class="bg-white border-2 border-black rounded-2xl p-4 neo-shadow">
          <p class="text-xs font-bold text-gray-500 uppercase tracking-widest">
            –¥–æ—Å—Ç–∞–≤–∫–∞
          </p>
          <p class="text-2xl font-black">24/7</p>
        </div>
        <div class="bg-white border-2 border-black rounded-2xl p-4 neo-shadow">
          <p class="text-xs font-bold text-gray-500 uppercase tracking-widest">
            –ø–æ–¥–¥–µ—Ä–∂–∫–∞
          </p>
          <p class="text-2xl font-black">LIVE</p>
        </div>
      </section>

      <!-- Featured Products (Dynamic Preview) -->
      <section class="space-y-4">
        <div class="flex items-center justify-between">
          <h3 class="text-2xl font-extrabold lowercase">–Ω–æ–≤–∏–Ω–∫–∏</h3>
          <a href="/products" class="text-sm font-bold border-b-2 border-black"
            >—Å–º–æ—Ç—Ä–µ—Ç—å –≤—Å–µ</a
          >
        </div>

        <!-- Skeleton Loader / Container -->
        <div id="featured-products" class="grid grid-cols-1 gap-6">
          <div
            class="animate-pulse bg-white border-2 border-black rounded-2xl p-4 h-32 flex items-center justify-center"
          >
            <span class="font-bold opacity-20 italic text-xl"
              >–ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∏–ª—å–Ω—ã–µ –≤–µ—â–∏...</span
            >
          </div>
        </div>
      </section>

      <!-- Footer / Contact -->
      <footer class="bg-black text-white rounded-3xl p-8 space-y-6">
        <div class="space-y-2">
          <p class="text-3xl font-extrabold lowercase italic">
            –æ—Å—Ç–∞–ª–∏—Å—å –≤–æ–ø—Ä–æ—Å—ã?
          </p>
          <p class="text-gray-400 font-bold leading-relaxed">
            –ù–∞–ø–∏—à–∏ –Ω–∞—à–µ–º—É –º–µ–Ω–µ–¥–∂–µ—Ä—É –≤ –æ–¥–Ω–æ –∫–∞—Å–∞–Ω–∏–µ. –ú—ã –≤—Å–µ–≥–¥–∞ –Ω–∞ —Å–≤—è–∑–∏.
          </p>
        </div>
        <button
          class="w-full py-4 bg-[#FCD34D] text-black border-2 border-white rounded-2xl font-extrabold text-lg neo-press"
        >
          <a href="/support">–Ω–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É</a>
        </button>
        <div
          class="pt-4 border-t border-white/20 text-center text-xs text-gray-500 font-bold uppercase tracking-widest"
        >
          v1.0.0 ‚Äî mdm digital systems
        </div>
      </footer>
    </main>

    <!-- JS Logic -->
    <script>
      async function fetchFeaturedProducts() {
        const container = document.getElementById("featured-products");
        try {
          // –ó–∞–ø—Ä–æ—Å –∫ –≤–∞—à–µ–º—É —ç–Ω–¥–ø–æ–∏–Ω—Ç—É API /api/products
          const response = await fetch("/api/products?limit=3");
          const data = await response.json();

          if (data.items && data.items.length > 0) {
            container.innerHTML = data.items
              .map(
                (product) => `
                        <div class="bg-white border-2 border-black rounded-2xl overflow-hidden neo-shadow flex group">
                            <div class="w-1/3 border-r-2 border-black bg-gray-100 flex items-center justify-center overflow-hidden">
                                ${
                                  product.image
                                    ? `<img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover group-hover:scale-110 transition-transform duration-300">`
                                    : `<span class="text-4xl">üì¶</span>`
                                }
                            </div>
                            <div class="p-4 flex flex-col justify-between flex-1">
                                <div>
                                    <p class="text-xs font-bold text-gray-400 uppercase tracking-tighter mb-1">
                                        art: ${product.vendor_code || "N/A"}
                                    </p>
                                    <h4 class="text-lg font-extrabold leading-tight mb-2">${
                                      product.name
                                    }</h4>
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-xl font-black">${product.price.toLocaleString()} ‚ÇΩ</span>
                                    <a href="/products/${
                                      product.id
                                    }" class="w-10 h-10 bg-[#FCD34D] border-2 border-black rounded-full flex items-center justify-center neo-shadow-sm neo-press text-xl">
                                        ‚Üí
                                    </a>
                                </div>
                            </div>
                        </div>
                    `
              )
              .join("");
          } else {
            container.innerHTML = `
                        <div class="bg-white border-2 border-black rounded-2xl p-8 text-center neo-shadow">
                            <p class="font-bold opacity-50 italic">–°–∫–ª–∞–¥ –ø—É—Å—Ç, –Ω–æ —Å–∫–æ—Ä–æ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∂–∞—Ä–∫–æ üî•</p>
                        </div>
                    `;
          }
        } catch (error) {
          console.error("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:", error);
          container.innerHTML = `
                    <div class="bg-red-50 border-2 border-black rounded-2xl p-4 neo-shadow">
                        <p class="font-bold text-red-600">–û—à–∏–±–∫–∞ —Å–≤—è–∑–∏ —Å –±–∞–∑–æ–π. –ü—Ä–æ–≤–µ—Ä—å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç!</p>
                    </div>
                `;
          document.getElementById("api-status").className =
            "flex items-center gap-2 px-3 py-1 bg-red-100 border-2 border-black rounded-full text-xs font-bold";
          document.getElementById("api-status").innerHTML =
            '<span class="w-2 h-2 bg-red-500 rounded-full"></span> OFFLINE';
        }
      }

      // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è API
      async function checkHealth() {
        try {
          const res = await fetch("/api/health");
          if (!res.ok) throw new Error();
        } catch {
          const status = document.getElementById("api-status");
          status.className =
            "flex items-center gap-2 px-3 py-1 bg-red-100 border-2 border-black rounded-full text-xs font-bold";
          status.innerHTML =
            '<span class="w-2 h-2 bg-red-500 rounded-full"></span> ERROR';
        }
      }

      window.onload = () => {
        fetchFeaturedProducts();
        checkHealth();
      };
    </script>
  </body>
</html>
